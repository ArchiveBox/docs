

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Security Overview &mdash; ArchiveBox 0.4.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Publishing Your Archive" href="Publishing-Your-Archive.html" />
    <link rel="prev" title="Troubleshooting" href="Troubleshooting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> ArchiveBox
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">How does it work?</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#quickstart">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#overview">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#documentation">Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="README.html#screenshots">Screenshots</a></li>
<li class="toctree-l1"><a class="reference internal" href="Roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="Changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="Donations.html">Donations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Web-Archiving-Community.html">Web Archiving Community</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="Install.html">Install</a></li>
<li class="toctree-l1"><a class="reference internal" href="Docker.html">Docker</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html">General Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html#archive-method-toggles">Archive Method Toggles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html#archive-method-options">Archive Method Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html#shell-options">Shell Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html#dependency-options">Dependency Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="Configuration.html#creating-a-config-file">Creating a Config File</a></li>
<li class="toctree-l1"><a class="reference internal" href="Troubleshooting.html">Troubleshooting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Security Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#usage-modes">Usage Modes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#public-mode-default">Public Mode [Default]</a></li>
<li class="toctree-l3"><a class="reference internal" href="#private-mode">Private Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stealth-mode">Stealth Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#do-not-run-as-root">Do not run as root</a></li>
<li class="toctree-l2"><a class="reference internal" href="#output-folder">Output Folder</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#permissions">Permissions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#filesystem">Filesystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#publishing">Publishing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Publishing-Your-Archive.html">Publishing Your Archive</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ArchiveBox</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Security Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Security-Overview.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="security-overview">
<h1>Security Overview<a class="headerlink" href="#security-overview" title="Permalink to this headline">¶</a></h1>
<div class="section" id="usage-modes">
<h2>Usage Modes<a class="headerlink" href="#usage-modes" title="Permalink to this headline">¶</a></h2>
<p>ArchiveBox has three common usage modes outlined below.</p>
<img src="https://i.imgur.com/K3dZcjG.png" width="50px" align="right"/><div class="section" id="public-mode-default">
<h3>Public Mode [Default]<a class="headerlink" href="#public-mode-default" title="Permalink to this headline">¶</a></h3>
<p>This is the default (lax) mode, intended for archiving public (non-secret) URLs without authenticating the headless browser.  This is the mode used if you’re archiving news articles, audio, video, etc. browser bookmarks to a folder published on your webserver. This allows you to access and link to content on <code class="docutils literal notranslate"><span class="pre">http://your.archive.com/archive...</span></code> after the originals go down.</p>
<p>This mode should not be used for archiving entire browser history or authenticated private content like Google Docs, paywalled content, invite-only subreddits, etc.</p>
<img src="https://i.imgur.com/xg6TxoK.png" width="50px" align="right"/></div>
<div class="section" id="private-mode">
<h3>Private Mode<a class="headerlink" href="#private-mode" title="Permalink to this headline">¶</a></h3>
<p>ArchiveBox is designed to be able to archive content that requires authentication or cookies.  This includes paywalled content, private forums, LAN-only content, etc.</p>
<p>To get started, set <a class="reference external" href="https://github.com/pirate/ArchiveBox/wiki/Configuration#chrome_user_data_dir"><code class="docutils literal notranslate"><span class="pre">CHROME_USER_DATA_DIR</span></code></a> and <a class="reference external" href="https://github.com/pirate/ArchiveBox/wiki/Configuration#COOKIES_FILE"><code class="docutils literal notranslate"><span class="pre">COOKIES_FILE</span></code></a> to point to a Chrome user folder that has your sessions and a wget <code class="docutils literal notranslate"><span class="pre">cookies.txt</span></code> file respectively.</p>
<p>If you’re importing private links or authenticated content, you probably don’t want to share your archive folder publicly on a webserver, so don’t follow the [[Publishing Your Archive]] instructions unless you are only serving it on a trusted LAN or have some sort of authentication in front of it.  Make sure to point ArchiveBox to an output folder with conservative permissions, as it may contain archived content with secret session tokens or pieces of your user data.  You may also wish to encrypt the archive using an encrypted disk image or filesystem like ZFS as it will contain all requests and response data, including session keys, user data, usernames, etc.</p>
<img src="https://i.imgur.com/DfyQUDV.png" width="50px" align="right"/></div>
<div class="section" id="stealth-mode">
<h3>Stealth Mode<a class="headerlink" href="#stealth-mode" title="Permalink to this headline">¶</a></h3>
<p>If you want ArchiveBox to be less noisy and avoid leaking any URLs to 3rd-party APIs during archiving, you can disable the options below.  Disabling these are recommended if you plan on archiving any sites that use secret tokens in the URL to grant access to private content without authentication, e.g. Google Docs, CodiDM notepads, etc.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">https://web.archive.org/save/{url}</span></code> when <a class="reference external" href="https://github.com/pirate/ArchiveBox/wiki/Configuration#submit_archive_dot_org"><code class="docutils literal notranslate"><span class="pre">SUBMIT_ARCHIVE_DOT_ORG</span></code></a> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, full URLs are submitted to the Wayback Machine for archiving, but no cookies or content from the local authenticated archive are shared</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">https://www.google.com/s2/favicons?domain={domain}</span></code> when <a class="reference external" href="https://github.com/pirate/ArchiveBox/wiki/Configuration#fetch_favicon"><code class="docutils literal notranslate"><span class="pre">FETCH_FAVICON</span></code></a> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the domains for each link are shared in order to get the favicon, but not the full URL</p></li>
</ul>
</div>
</div>
<div class="section" id="do-not-run-as-root">
<h2>Do not run as root<a class="headerlink" href="#do-not-run-as-root" title="Permalink to this headline">¶</a></h2>
<img src="https://i.imgur.com/yDqJc4I.jpg" width="150px" align="right"><p>Do not run ArchiveBox as root for a number of reasons:</p>
<ul class="simple">
<li><p>Chrome will execute as root and fail immediately because Chrome sandboxing is pointless when the data directory is opened as root (do not set <code class="docutils literal notranslate"><span class="pre">CHROME_SANDBOX=False</span></code> just to bypass that error!)</p></li>
<li><p>All dependencies will be run as root, if any of them have a vulnerability that’s exploited by sites you’re archiving you’re opening yourself up to full system compromise</p></li>
<li><p>ArchiveBox does lots of HTML parsing, filesystem access, and shell command execution.  A bug in any one of those subsystems could potentially lead to deleted/damaged data on your hard drive, or full system compromise unless restricted to a user that only has permissions to access the directories needed</p></li>
<li><p>Do you really trust a project created by a Github user called <code class="docutils literal notranslate"><span class="pre">&#64;pirate</span></code> 😉? Why give a random program off the internet root access to your entire system? (I don’t have malicious intent, I’m just saying in principle you should not be running random Github projects as root)</p></li>
</ul>
<p><strong>Instead, you should run ArchiveBox as your normal user, or create a user with less privileged access:</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>useradd -r -g archivebox -G audio,video archivebox
mkdir -p /home/archivebox/data
chown -R archivebox:archivebox /home/archivebox
...
sudo -u archivebox ./archive ...
</pre></div>
</div>
<img src="https://i.imgur.com/ca1he6I.png" width="40px" align="right"/></div>
<div class="section" id="output-folder">
<h2>Output Folder<a class="headerlink" href="#output-folder" title="Permalink to this headline">¶</a></h2>
<div class="section" id="permissions">
<h3>Permissions<a class="headerlink" href="#permissions" title="Permalink to this headline">¶</a></h3>
<p>What are the permissions on the archive folder? Limit access to the fewest possible users by checking folder ownership and setting <a class="reference external" href="https://github.com/pirate/ArchiveBox/wiki/Configuration#OUTPUT_PERMISSIONS"><code class="docutils literal notranslate"><span class="pre">OUTPUT_PERMISSIONS</span></code></a> accordingly.</p>
</div>
<div class="section" id="filesystem">
<h3>Filesystem<a class="headerlink" href="#filesystem" title="Permalink to this headline">¶</a></h3>
<p>How much are you planning to archive?  Only a few bookmarked articles, or thousands of pages of browsing history a day?  If it’s only 1-50 pages a day, you can probably just stick it in a normal folder on your hard drive, but if you want to go over 100 pages a day, you will likely want to put your archive on a compressed/deduplicated/encrypted disk image or filesystem like ZFS.</p>
</div>
<div class="section" id="publishing">
<h3>Publishing<a class="headerlink" href="#publishing" title="Permalink to this headline">¶</a></h3>
<p>Are you publishing your archive? If so, make sure you’re only serving it as HTML and not accidentally running it as php or cgi, and put it on its own domain not shared with other services.  This is done in order to avoid cookies leaking between your main domain and domains hosting content you don’t control.  Many companies put user provided files on separate domains like googleusercontent.com and github.io to avoid this problem.</p>
<p>Published archives automatically include a <code class="docutils literal notranslate"><span class="pre">robots.txt</span></code> <code class="docutils literal notranslate"><span class="pre">Dissallow:</span> <span class="pre">/</span></code> to block search engines from indexing them. You may still wish to publish your contact info in the index footer though using <a class="reference external" href="https://github.com/pirate/ArchiveBox/wiki/Configuration#FOOTER_INFO"><code class="docutils literal notranslate"><span class="pre">FOOTER_INFO</span></code></a> so that you can respond to any DMCA and copyright takedown notices if you accidentally rehost copyrighted content.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Publishing-Your-Archive.html" class="btn btn-neutral float-right" title="Publishing Your Archive" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Troubleshooting.html" class="btn btn-neutral float-left" title="Troubleshooting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Nick Sweeting

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>